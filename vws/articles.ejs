<html>
  <head>
    <meta charset="utf-8">
    <title><%= blog.title %></title>
    <link rel="stylesheet" href="/lib/swiper/swiper-3.4.2.min.css">
    <link rel="stylesheet" href="/lib/noty/noty.min.css">
    <link rel="stylesheet" href="/dist/css/app.css">
  </head>
  <body>
    <div class="app app-articles">
      <%- include('components/nav') %>
      <div class="app-main clearfix">
        <div class="app-banner">
          <div class="swiper-container hlw-swiper">
            <div class="swiper-wrapper">
              <div class="swiper-slide">
                <img data-src="/dist/img/hlw0.jpeg" class="swiper-lazy">
                <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
              </div>
              <div class="swiper-slide">
                <img data-src="/dist/img/hlw7.jpeg" class="swiper-lazy">
                <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
              </div>
              <div class="swiper-slide">
                <img data-src="/dist/img/hlw8.jpeg" class="swiper-lazy">
                <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
              </div>
              <div class="swiper-slide">
                <img data-src="/dist/img/hlw1.jpeg" class="swiper-lazy">
                <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
              </div>
              <div class="swiper-slide">
                <img data-src="/dist/img/hlw2.jpeg" class="swiper-lazy">
                <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
              </div>
              <div class="swiper-slide">
                <img data-src="/dist/img/hlw3.jpeg" class="swiper-lazy">
                <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
              </div>
              <div class="swiper-slide">
                <img data-src="/dist/img/hlw4.jpeg" class="swiper-lazy">
                <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
              </div>
              <div class="swiper-slide">
                <img data-src="/dist/img/hlw5.jpeg" class="swiper-lazy">
                <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
              </div>
              <div class="swiper-slide">
                <img data-src="/dist/img/hlw6.jpeg" class="swiper-lazy">
                <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
              </div>
            </div>
            <div class="swiper-pagination"></div>
          </div>
          <div class="swiper-container movie-swiper">
            <div class="swiper-wrapper">
              <% movies.forEach(function (movie) {%>
              <a class="swiper-slide" href="/movies/<%= movie._id %>">
                <img src="<%= movie.cover %>" alt="">
                <div class="movie-info">
                  <p class="p1"><%- movie.name %></p>
                  <p class="p2">
                    <span class="movie_score">IMDb：<%- movie.score %></span>
                  </p>
                </div>
              </a>
              <%})%>
            </div>
            <!-- Add Arrows -->
            <div class="swiper-button-next swiper-button-white"></div>
            <div class="swiper-button-prev swiper-button-white"></div>
        </div>
        </div>
        <div class="app-main_content news-list">
          <% articles.forEach(function (article) { %>
            <%- include('components/article-item', { article: article }) %>
          <% }) %>
          <%- include('components/page-nav') %>
        </div>
        <%- include('components/side') %>
      </div>
      <%- include('components/footer') %>
      <script src="/lib/swiper/swiper-3.4.2.jquery.min.js"></script>
      <script>
        new Swiper('.movie-swiper', {
          paginationClickable: true,
          nextButton: '.swiper-button-next',
          prevButton: '.swiper-button-prev',
          autoplay: 4000,
          speed: 1000,
          effect : 'cube',
          cube: {
            slideShadows: true,
            shadow: true,
            shadowOffset: 100,
            shadowScale: 0.6
          },
          loop: true
        })
        new Swiper('.hlw-swiper', {
          pagination: '.swiper-pagination',
          paginationClickable: true,
          effect : 'fade',
          autoplay: 3000,
          speed: 1000,
          // Disable preloading of all images
          preloadImages: true,
          // Enable lazy loading
          lazyLoading: true
        })
        $.getScript('http://php.weather.sina.com.cn/iframe/index/w_cl.php?code=js&day=0&city=&dfc=1&charset=utf-8',function(res){
          if (window.SWther.w.length === 0) {
            return
          }
          var s = ""
          var r = ""
          var q = ""
          for(s in window.SWther.w){
            q = SWther.w[s][0]
            r = {
              city: s,
              date: SWther.add.now.split(" ")[0]||"",
              day_weather: q.s1,
              night_weather: q.s2,
              day_temp: q.t1,
              night_temp: q.t2,
              day_wind: q.p1,
              night_wind: q.p2
            }
          }
          console.log(r)
          var date = new Date()
          var hour = date.getHours()
          var weather = hour > 19 ? r.night_weather : r.day_weather  //天气
          $weatherIcon = $('.weather_icon')
          if (weather.indexOf('小雨') != -1) {
            $weatherIcon.addClass('icon-drizzle')
          } else if (weather.indexOf('中雨') != -1 || weather.indexOf('大雨') != -1){
            $weatherIcon.addClass('icon-rain')
          } else {
            $weatherIcon.addClass('icon-sun')
          }
          $('.temp_max').text(r.day_temp + '℃')
          $('.temp_min').text(r.night_temp + '℃')
          $('.weather_city').text(r.city)
          $('.weather_date').text(r.date)
          var $weatherLoading = $('.weather_loading')
          setTimeout(function () {
            $weatherLoading.animate({
              opacity: 0
            }, 500, function() {
              $weatherLoading.hide()
            })
          }, 1000)
        })
      </script>
    </div>
  </body>
</html>
